#!/bin/bash

# Έλεγχος αν δόθηκε τουλάχιστον ένα όρισμα
if [ "$#" -eq 0 ]; then
    echo "Χρήση: ./askisi2b.sh <αρχείο1> [αρχείο2] [...]"
    echo "Πρέπει να δώσετε τουλάχιστον ένα όνομα αρχείου για έλεγχο."
    exit 1
fi

echo "Γίνεται έλεγχος των δοσμένων αρχείων"
echo

# Μετρητής για τα αρχεία που βρέθηκαν
found_count=0

# Κάνουμε βρόχο (loop) σε ΟΛΑ τα ορίσματα που δόθηκαν ($@)
for file_path in "$@"; do
    
    echo "Έλεγχος για: «$file_path»"
    
    # α. Έλεγχος αν υπάρχει (με το -e ελέγχει για αρχεία, φακέλους, τα πάντα δηλαδή)
    if [ ! -e "$file_path" ]; then
        echo "   -> Το «$file_path» δεν υπάρχει."
    else
        # β. & γ. Υπάρχει
        # Αυξάνουμε τον μετρητή και συνεχίζουμε
        ((found_count++))
        
        # Χρησιμοποιούμε realpath για να βρούμε την απόλυτη διαδρομή
        # Η επιλογή -m διορθώνει τυχόν ../ ή ./ στη διαδρομή
        abs_path=$(realpath -m "$file_path")
        
        echo "   -> Το αρχείο: «$file_path» υπάρχει."
        echo "   -> Απόλυτη διαδρομή: «$abs_path»"
    
        # Έλεγχος για δικαίωμα εγγραφής (-w)
        if [ -w "$file_path" ]; then
            # γ. Υπάρχει και έχετε δικαίωμα
            echo "   -> Έχετε δικαιώματα να επεξεργαστείτε το αρχείο."
        else
            # β. Υπάρχει αλλά δεν έχετε δικαίωμα
            echo "   -> Δεν έχετε δικαίωμα επεξεργασίας για αυτό το αρχείο."
        fi
    fi
    echo "-------"
done

echo
echo "--- Ολοκληρώθηκε ο Έλεγχος ---"
echo "Βρέθηκαν συνολικά $found_count από τα $# αρχεία/διαδρομές που δώσατε."
